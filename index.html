<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Industrial HVAC Monitoring System</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Roboto:wght@400;500&family=JetBrains+Mono:wght@500;700&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f7fafc;
        }

        h1,
        h2,
        h3 {
            font-family: 'Poppins', sans-serif;
        }

        .mono-font {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Seven Segment Box (Professional) */
        .seven-seg-container {
            background: #0f172a;
            border-radius: 8px;
            padding: 8px 12px;
            height: 70px;
            width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #1e293b;
        }

        .status-badge {
            padding: 2px 10px;
            font-size: 12px;
            font-weight: 600;
            border-radius: 999px;
            background: #dcfce7;
            color: #166534;
        }
    </style>
</head>

<body class="min-h-screen">

    <!-- Navbar -->
    <nav class="bg-blue-600 text-white shadow-md">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-3">
                <div class="text-xl font-bold">Vizibble</div>
                <div class="flex gap-6 text-sm">
                    <a class="border-b-2 border-white pb-1">Dashboard</a>
                    <a class="text-blue-200 hover:text-white" href="./diff-pressure.html">Differential Pressure</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- MAIN -->
    <main class="container mx-auto px-4 py-8">

        <!-- GRID -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-stretch">

            <!-- LEFT KPI COLUMN -->
            <div class="flex flex-col gap-8 h-full">

                <!-- TEMPERATURE CARD -->
                <div class="bg-white border rounded-xl p-6 flex flex-col h-full">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-gray-600 font-semibold text-sm uppercase">Temperature</h3>
                        <span class="status-badge">Normal</span>
                    </div>

                    <!-- KPI + Seven Seg -->
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="text-5xl font-bold text-blue-600 mono-font">
                                24.6<span class="text-2xl">°C</span>
                            </div>
                            <div class="text-gray-500 text-sm mt-1">Current Value</div>
                        </div>

                        <div class="seven-seg-container">
                            <div id="tempDisplay"></div>
                        </div>
                    </div>

                    <!-- Stats -->
                    <div class="mt-auto grid grid-cols-2 gap-4 pt-4 border-t text-sm">
                        <div>
                            <div class="text-gray-500">Min (24h)</div>
                            <div class="font-semibold">20.5°C</div>
                        </div>
                        <div>
                            <div class="text-gray-500">Max (24h)</div>
                            <div class="font-semibold">27.8°C</div>
                        </div>
                    </div>
                </div>

                <!-- HUMIDITY CARD -->
                <div class="bg-white border rounded-xl p-6 flex flex-col h-full">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-gray-600 font-semibold text-sm uppercase">Humidity</h3>
                        <span class="status-badge">Normal</span>
                    </div>

                    <div class="flex justify-between items-center">
                        <div>
                            <div class="text-5xl font-bold text-teal-600 mono-font">
                                45<span class="text-2xl">%</span>
                            </div>
                            <div class="text-gray-500 text-sm mt-1">Current Value</div>
                        </div>

                        <div class="seven-seg-container">
                            <div id="humidityDisplay"></div>
                        </div>
                    </div>

                    <div class="mt-auto grid grid-cols-2 gap-4 pt-4 border-t text-sm">
                        <div>
                            <div class="text-gray-500">Min (24h)</div>
                            <div class="font-semibold">38%</div>
                        </div>
                        <div>
                            <div class="text-gray-500">Max (24h)</div>
                            <div class="font-semibold">58%</div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- RIGHT CHART -->
            <div class="lg:col-span-2 bg-white border rounded-xl p-6 h-full">
                <h3 class="font-bold text-gray-800 text-xl mb-4">Today Overview</h3>
                <div id="combinedChart" style="height: 480px;"></div>
            </div>

        </div>

        <!-- HISTORICAL -->
        <div class="mt-8 bg-white border rounded-xl p-6">
            <h3 class="font-bold text-gray-800 text-xl mb-4">Last Week</h3>
            <div id="historicalChart" style="height:400px;"></div>
        </div>

    </main>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sevenSeg.js/0.2.0/sevenSeg.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>

    <script>
        $(document).ready(function () {
            // --- INITIALIZATION ---
            const initialTemp = 24.6;
            const initialHum = 45;

            // Seven Segment Displays
            $('#tempDisplay').sevenSeg({ value: initialTemp, digits: 3, decimalPoint: true });
            $('#humidityDisplay').sevenSeg({ value: initialHum, digits: 3 });

            // --- ECHARTS SETUP ---
            const combinedChart = echarts.init(document.getElementById('combinedChart'));
            const historicalChart = echarts.init(document.getElementById('historicalChart'));

            let timeData = generateInitialData(50);

            function generateInitialData(points) {
                const data = [];
                const start = new Date();
                start.setSeconds(start.getSeconds() - points * 2); // Start 'points' * 2 seconds ago
                let temp = initialTemp;
                let hum = initialHum;

                for (let i = 0; i < points; i++) {
                    const time = new Date(start.getTime() + i * 2000);
                    temp += (Math.random() - 0.5) * 0.2;
                    hum += (Math.random() - 0.5) * 1;
                    temp = Math.max(20, Math.min(28, temp));
                    hum = Math.max(35, Math.min(60, hum));
                    data.push({ time, temp: parseFloat(temp.toFixed(1)), humidity: Math.round(hum) });
                }
                return data;
            }

            combinedChart.setOption({
                tooltip: { trigger: 'axis' },
                legend: { data: ['Temperature', 'Humidity'] },
                xAxis: { type: 'time' },
                yAxis: [
                    { type: 'value', name: '°C', min: 18, max: 30 },
                    { type: 'value', name: '%RH', min: 30, max: 65 }
                ],
                series: [
                    { name: 'Temperature', type: 'line', smooth: true, showSymbol: false, data: timeData.map(d => [d.time, d.temp]) },
                    { name: 'Humidity', type: 'line', smooth: true, yAxisIndex: 1, showSymbol: false, data: timeData.map(d => [d.time, d.humidity]) }
                ]
            });

            historicalChart.setOption({
                tooltip: { trigger: 'axis' },
                legend: { data: ['Avg Temperature', 'Avg Humidity'] },
                xAxis: { type: 'category', data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] },
                yAxis: [
                    { type: 'value', name: '°C' },
                    { type: 'value', name: '%RH' }
                ],
                series: [
                    { name: 'Avg Temperature', type: 'bar', data: [23.5, 24.2, 23.8, 24.5, 24.1, 23.6, 24.3] },
                    { name: 'Avg Humidity', type: 'bar', yAxisIndex: 1, data: [46, 44, 47, 45, 46, 48, 45] }
                ]
            });

            // --- LIVE DATA UPDATE ---
            function updateLiveData() {
                const lastDataPoint = timeData[timeData.length - 1];
                let temp = lastDataPoint.temp;
                let hum = lastDataPoint.humidity;

                // Generate new values
                temp += (Math.random() - 0.5) * 0.2;
                hum += (Math.random() - 0.5) * 1;
                temp = Math.max(20, Math.min(28, temp));
                hum = Math.max(35, Math.min(60, hum));
                const newTemp = parseFloat(temp.toFixed(1));
                const newHum = Math.round(hum);

                // Update KPIs
                $('.text-blue-600.mono-font').html(`${newTemp.toFixed(1)}<span class="text-2xl">°C</span>`);
                $('.text-teal-600.mono-font').html(`${newHum}<span class="text-2xl">%</span>`);

                // Update Seven Segment
                $('#tempDisplay').sevenSeg({ value: newTemp });
                $('#humidityDisplay').sevenSeg({ value: newHum });

                // Update Status Badges
                updateStatusBadge(newTemp, 27, 25, 21, 19, $('.status-badge').eq(0));
                updateStatusBadge(newHum, 55, 50, 40, 38, $('.status-badge').eq(1));

                // Update Chart
                const now = new Date();
                timeData.push({ time: now, temp: newTemp, humidity: newHum });
                timeData.shift(); // Keep the data window constant

                combinedChart.setOption({
                    series: [
                        { data: timeData.map(d => [d.time, d.temp]) },
                        { data: timeData.map(d => [d.time, d.humidity]) }
                    ]
                });
            }

            function updateStatusBadge(value, high_danger, high_warn, low_warn, low_danger, badgeElement) {
                if (value >= high_danger || value <= low_danger) {
                    badgeElement.text('Danger').css({ 'background-color': '#fecaca', 'color': '#991b1b' });
                } else if (value >= high_warn || value <= low_warn) {
                    badgeElement.text('Warning').css({ 'background-color': '#fef08a', 'color': '#854d0e' });
                } else {
                    badgeElement.text('Normal').css({ 'background-color': '#dcfce7', 'color': '#166534' });
                }
            }

            setInterval(updateLiveData, 2000);

            // --- RESPONSIVE RESIZE ---
            window.addEventListener('resize', () => {
                combinedChart.resize();
                historicalChart.resize();
            });
        });
    </script>

</body>

</html>